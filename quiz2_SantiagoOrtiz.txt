CREATE TABLE SALARIES(
ID NUMBER (*,0) PRIMARY KEY,
EMPLOYEE_ID NUMBER(*,0) NOT NULL,
PROJECT_ID NUMBER(*,0),
SALARY NUMBER(10,0) NOT NULL CHECK (SALARY > 500)
);

CREATE TABLE PROJECTS(
ID NUMBER (*,0) PRIMARY KEY,
CODE VARCHAR2(255) NOT NULL,
MANAGER_ID NUMBER(*,0),
BUDGET NUMBER(10,2) NOT NULL,
DATE_OF_BEGINNING DATE,
DATE_OF_ENDING DATE
);

CREATE TABLE EMPLOYEES(
ID NUMBER (*,0) PRIMARY KEY,
MANAGER_ID NUMBER(*,0),
DATE_OF_JOINING DATE NOT NULL,
FULL_NAME VARCHAR2(255) NOT NULL
);

ALTER TABLE EMPLOYEES
ADD CONSTRAINT FK_MANAGER
   FOREIGN KEY (MANAGER_ID)
   REFERENCES EMPLOYEES (ID);
   
ALTER TABLE PROJECTS
ADD CONSTRAINT FK_MANAGER_PROJECT
   FOREIGN KEY (MANAGER_ID)
   REFERENCES EMPLOYEES (ID);

ALTER TABLE SALARIES
ADD CONSTRAINT FK_SALARY_EMPLOYEE
   FOREIGN KEY (EMPLOYEE_ID)
   REFERENCES EMPLOYEES (ID);
   
ALTER TABLE SALARIES
ADD CONSTRAINT FK_SALARY_PROJECT
   FOREIGN KEY (PROJECT_ID)
   REFERENCES PROJECTS (ID);

   
SELECT COUNT(*)
FROM PROJECTS P INNER JOIN EMPLOYEES E ON (P.MANAGER_ID = E.ID)
WHERE P.CODE = '44905736599';

SELECT E.FULL_NAME
FROM SALARIES S INNER JOIN EMPLOYEES E ON (S.EMPLOYEE_ID = E.ID)
WHERE S.SALARY >= 1000 AND S.SALARY <= 2500
ORDER BY E.FULL_NAME DESC;

SELECT P.CODE, COUNT(E.ID)
FROM PROJECTS P INNER JOIN EMPLOYEES E ON (P.MANAGER_ID = E.ID)
GROUP BY P.CODE
ORDER BY COUNT(E.ID) ASC;

SELECT E.FULL_NAME
FROM PROJECTS P RIGHT OUTER JOIN EMPLOYEES E ON (P.MANAGER_ID = E.ID);

SELECT E.FULL_NAME
FROM PROJECTS P LEFT OUTER JOIN EMPLOYEES E ON (P.MANAGER_ID = E.ID);

SELECT E.FULL_NAME || ' - ' || B.FULL_NAME AS employee_boss
FROM EMPLOYEES E INNER JOIN EMPLOYEES B ON (E.MANAGER_ID = B.ID);

SELECT FULL_NAME 
FROM EMPLOYEES 
WHERE FULL_NAME LIKE 'Kermit%';



